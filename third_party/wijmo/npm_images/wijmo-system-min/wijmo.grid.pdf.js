/*
    *
    * Wijmo Library 5.20171.282
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
System.register(['wijmo/wijmo.pdf','wijmo/wijmo','wijmo/wijmo.grid','wijmo/wijmo.grid.pdf'],function(n,t){"use strict";function v(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.multirow}function y(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.sheet}function e(n,t,i){var u,o,f;if(i===void 0&&(i=!1),t&&n)for(u in t)o=t[u],f=n[u],r.isObject(o)?((f===undefined||!r.isObject(f)&&i)&&(n[u]=f={}),r.isObject(f)&&e(n[u],o,i)):(f===undefined||i&&o!==undefined)&&(n[u]=o);return n}var tt=t&&t.id,c=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},f,r,i,p,u,h,w,l,b,k,a,s,d,g,o,nt;return{setters:[function(n){f=n},function(n){r=n},function(n){i=n},function(n){p=n}],execute:function(){window.wijmo=window.wijmo||{};window.wijmo.grid=window.wijmo.grid||{};window.wijmo.grid.pdf=p,function(n){n[n.ActualSize=0]="ActualSize";n[n.PageWidth=1]="PageWidth";n[n.SinglePage=2]="SinglePage"}(u||(u={}));n("ScaleMode",u),function(n){n[n.All=0]="All";n[n.Selection=1]="Selection"}(h||(h={}));n("ExportMode",h);w=function(){function n(){}return n.draw=function(n,t,i,o,s){r.assert(!!n,'The flex argument cannot be null.');r.assert(!!t,'The doc argument cannot be null.');var h=e({},s);e(h,this.DefaultDrawSettings);h.scaleMode=i==null?u.ActualSize:o==null?u.PageWidth:u.SinglePage;try{h.recalculateStarWidths&&n.columns._updateStarSizes(f.ptToPx(t.width));this._draw(n,t,null,i,o,h)}finally{h.recalculateStarWidths&&n.invalidate(!0)}},n.drawToPosition=function(n,t,i,o,s,h){r.assert(!!n,'The flex argument cannot be null.');r.assert(!!t,'The doc argument cannot be null.');r.assert(!!i,'The point argument cannot be null.');var c=e({},h);e(c,this.DefaultDrawSettings);c.scaleMode=o==null?u.ActualSize:s==null?u.PageWidth:u.SinglePage;try{c.recalculateStarWidths&&n.columns._updateStarSizes(f.ptToPx(t.width));this._draw(n,t,i,o,s,c)}finally{c.recalculateStarWidths&&n.invalidate(!0)}},n.export=function(n,t,i){var o,u;r.assert(!!n,'The flex argument cannot be null.');r.assert(!!t,'The fileName argument cannot be empty.');i=e({},i);e(i,this.DefaultExportSettings);o=i.documentOptions.ended;i.documentOptions.ended=function(n,i){o&&o.apply(u,[n,i])===!1||f.saveBlob(i.blob,t)};u=new f.PdfDocument(i.documentOptions);try{i.recalculateStarWidths&&n.columns._updateStarSizes(f.ptToPx(u.width));this._draw(n,u,null,null,null,i);u.end()}finally{i.recalculateStarWidths&&n.invalidate(!0)}},n._draw=function(n,t,i,u,f,e){var d=i!=null,h=new r.Size(t.width,t.height),s,k;i||(i=new r.Point(0,t.y));r.isArray(e.embeddedFonts)&&e.embeddedFonts.forEach(function(n){t.registerFont(n)});var b=o.getSelection(n,e.exportMode),a=this._getGridRenderer(n,b,!1,this.BorderWidth,null,!0),c=new r.Rect(i.x||0,i.y||0,u||h.width,f||h.height),l=this._getScaleFactor(a,e.scaleMode,c),v=this._getPages(a,b,c,e,d,l);for(s=0;s<v.length;s++){s>0&&t.addPage();var y=v[s],p=y.pageCol===0?c.left:0,w=y.pageRow===0?c.top:0;t.saveState();t.paths.rect(0,0,h.width,h.height).clip();t.scale(l,l,new r.Point(p,w));t.translate(p,w);k=this._getGridRenderer(n,y.range,e.repeatMergedValuesAcrossPages,this.BorderWidth,e.styles,s===v.length-1);k.render(t);t.restoreState();t.x=p;t.y=w+a.renderSize.height*l}},n._getScaleFactor=function(n,t,i){var f=1,e,r;return t===u.ActualSize?f:(e=n.renderSize,t===u.SinglePage?(r=Math.min(i.width/e.width,i.height/e.height),r<1&&(f=r)):(r=i.width/e.width,r<1&&(f=r)),f)},n._getPages=function(n,t,i,r,e,o){var ht=this,h=[],c=[],p=f.pxToPt,w=n.flex,g=n.showColumnHeader,tt=n.showRowHeader,b=g?p(w.columnHeaders.height):0,k=tt?p(w.rowHeaders.width):0,yt=r.scaleMode===u.ActualSize||r.scaleMode===u.PageWidth,pt=r.scaleMode===u.ActualSize,wt=(i.width-i.left)*(1/o),bt=(i.height-i.top)*(1/o),kt=i.width*(1/o),dt=i.height*(1/o),v=b,y=k,ct=e&&r.scaleMode==u.ActualSize,it,rt,ut,ft,d,et,s,l,st,vt;if(yt&&(it=0,t.forEach(w.cells,function(n,t,i,r){var f=h.length?dt:bt,u;a.isRenderableRow(n)&&(u=p(n.renderHeight),it++,v+=u,(g||it>1)&&(v-=ht.BorderWidth),v>f&&(b+u>f||ct?(h.push(r),v=b):(h.push(r-1),v=b+u),g&&(v-=ht.BorderWidth)))})),rt=t.length()-1,h.length&&h[h.length-1]===rt||h.push(rt),pt)for(ut=0,s=t.leftCol;s<=t.rightCol;s++)ft=w.columns[s],ft.isVisible&&(d=p(ft.renderWidth),et=c.length?kt:wt,ut++,y+=d,(tt||ut>1)&&(y-=this.BorderWidth),y>et&&(k+d>et||ct?(c.push(s),y=k):(c.push(s-1),y=k+d),tt&&(y-=this.BorderWidth)));c.length&&c[c.length-1]===t.rightCol||c.push(t.rightCol);var lt=[],ot=!1,at=1,gt=e&&r.maxPages>0?1:r.maxPages;for(s=0;s<h.length&&!ot;s++)for(l=0;l<c.length&&!ot;l++,at++)(ot=at>gt)||(st=s==0?0:h[s-1]+1,vt=l==0?t.leftCol:c[l-1]+1,lt.push(new nt(t.subrange(st,h[s]-st+1,vt,c[l]),l,s)));return lt},n._getGridRenderer=function(n,t,i,r,u,f){var e=v()&&n instanceof v().MultiRow&&k||y()&&n instanceof y().FlexSheet&&b||l;return new e(n,t,i,r,u,f)},n.BorderWidth=1,n.DefaultDrawSettings={maxPages:Number.MAX_VALUE,exportMode:h.All,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:new f.PdfFont,padding:1.5,verticalAlign:'middle'},headerCellStyle:{font:{weight:'bold'}}}},n.DefaultExportSettings=e({scaleMode:u.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}}},n.DefaultDrawSettings),n}();n("FlexGridPdfConverter",w);l=function(){function n(n,t,r,u,f,e){this._flex=n;this._borderWidth=u;this._lastPage=e;this._topLeft=new s(this,n.topLeftCells,this.showRowHeader&&this.showColumnHeader?new o(n,[new i.CellRange(0,0,n.topLeftCells.rows.length-1,n.topLeftCells.columns.length-1)]):new o(n,[]),r,u,f);this._rowHeader=new s(this,n.rowHeaders,this.showRowHeader?t.clone(0,n.rowHeaders.columns.length-1):new o(n,[]),r,u,f);this._columnHeader=new s(this,n.columnHeaders,this.showColumnHeader?new o(n,[new i.CellRange(0,t.leftCol,n.columnHeaders.rows.length-1,t.rightCol)]):new o(n,[]),r,u,f);this._cells=new s(this,n.cells,t,r,u,f);this._bottomLeft=new s(this,n.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new o(n,[new i.CellRange(0,0,n.bottomLeftCells.rows.length-1,n.bottomLeftCells.columns.length-1)]):new o(n,[]),r,u,f);this._columnFooter=new s(this,n.columnFooters,this.showColumnFooter?new o(n,[new i.CellRange(0,t.leftCol,n.columnFooters.rows.length-1,t.rightCol)]):new o(n,[]),r,u,f)}return n.prototype.render=function(n){var i=Math.max(0,this._rowHeader.renderSize.width-this._borderWidth),t=Math.max(0,this._columnHeader.renderSize.height-this._borderWidth);this._topLeft.render(n,0,0);this._rowHeader.render(n,0,t);this._columnHeader.render(n,i,0);this._cells.render(n,i,t);t=Math.max(0,t+this._cells.renderSize.height-this._borderWidth);this._bottomLeft.render(n,0,t);this._columnFooter.render(n,i,t)},Object.defineProperty(n.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"renderSize",{get:function(){var n=this._columnHeader.renderSize.height+this._cells.renderSize.height+this._columnFooter.renderSize.height,t=this._rowHeader.renderSize.width+this._cells.renderSize.width;return this._columnHeader.visibleRows>0&&(n-=this._borderWidth),this._columnFooter.visibleRows>0&&(n-=this._borderWidth),this._rowHeader.visibleColumns>0&&(t-=this._borderWidth),new r.Size(t,n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&i.HeadersVisibility.Column)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&i.HeadersVisibility.Row)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0}),n.prototype.getCellValue=function(n,t,i){return n.getCellData(i,t,!0)},n.prototype.getColumn=function(n,t){return n.columns[t]},n.prototype.isAlternatingRow=function(n){return n.index%2!=0},n.prototype.isMergeableCell=function(n,t){return t.allowMerging||n.allowMerging||t instanceof i.GroupRow},n}();b=function(n){function t(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e)}return c(t,n),t.prototype.getCellValue=function(t,r,u){return t.cellType===i.CellType.Cell?t.rows[u]instanceof y().HeaderRow?this.flex.columnHeaders.getCellData(u,r,!0):this.flex.getCellValue(u,r,!0):n.prototype.getCellValue.call(this,t,r,u)},Object.defineProperty(t.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(l);k=function(n){function t(t,i,r,u,f,e){n.call(this,t,i,r,u,f,e)}return c(t,n),t.prototype.getColumn=function(n,t,i){return this.flex.getBindingColumn(n,i,t)},t.prototype.isAlternatingRow=function(t){return t instanceof v()._MultiRow?t.dataIndex%2!=0:n.prototype.isAlternatingRow.call(this,t)},t.prototype.isMergeableCell=function(){return!0},t}(l);a=function(){function n(n,t){this._panel=n;this._range=t.clone()}return n.isRenderableRow=function(n){return n.isVisible&&!(n instanceof i._NewRowTemplate)},Object.defineProperty(n.prototype,"visibleRows",{get:function(){var n=this;return this._visibleRows==null&&(this._visibleRows=0,this._range.forEach(this._panel,function(t){n.isRenderableRow(t)&&n._visibleRows++})),this._visibleRows},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleColumns",{get:function(){if(this._visibleColumns==null&&(this._visibleColumns=0,this._range.isValid))for(var n=this._range.leftCol;n<=this._range.rightCol;n++)this._panel.columns[n].isVisible&&this._visibleColumns++;return this._visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){if(this._size==null){var n=this._range.getRenderSize(this._panel);this._size=new r.Size(f.pxToPt(n.width),f.pxToPt(n.height))}return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),n.prototype.isRenderableRow=function(t){return n.isRenderableRow(t)},n}();s=function(n){function t(t,i,r,u,f,e){n.call(this,i,r);this._gr=t;this._repeatMergedValues=u;this._borderWidth=f;this._styles=e}return c(t,n),Object.defineProperty(t.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSize",{get:function(){return this._renderSize==null&&(this._renderSize=this.size.clone(),this.visibleColumns>1&&(this._renderSize.width-=this._borderWidth*(this.visibleColumns-1)),this.visibleRows>1&&(this._renderSize.height-=this._borderWidth*(this.visibleRows-1))),this._renderSize},enumerable:!0,configurable:!0}),t.prototype.getRangeWidth=function(n,t){for(var e,i=0,r=0,o=this.panel,u=n;u<=t;u++)e=o.columns[u],e.isVisible&&(r++,i+=e.renderWidth);return i=f.pxToPt(i),r>1&&(i-=this._borderWidth*(r-1)),i},t.prototype.getRangeHeight=function(n,t){for(var e,i=0,r=0,o=this.panel,u=n;u<=t;u++)e=o.rows[u],this.isRenderableRow(e)&&(r++,i+=e.renderHeight);return i=f.pxToPt(i),r>1&&(i=i-this._borderWidth*(r-1)),i},t.prototype.render=function(n,t,i){var r=this,u=this.range,o=this.panel,s=new d(this._gr.flex),f,e;if(u.isValid){for(f={},e=u.leftCol;e<=u.rightCol;e++)f[e]=i;u.forEach(o,function(i,e,h){var k,c,y,l,b;if(r.isRenderableRow(i))for(k=t,c=u.leftCol;c<=u.rightCol;c++){var d=r.gr.getColumn(o,c,h),p=undefined,a=undefined,v=undefined,w=undefined;if(d.isVisible){if(y=r._getCellValue(c,h),r.gr.isMergeableCell(d,i)&&(l=s.getMergedRange(o,h,c)))if(l.topRow!==l.bottomRow)l.firstVisibleRow===h||h===e.topRow?p={value:r._repeatMergedValues?y:l.firstVisibleRow===h?y:'',height:a=r.getRangeHeight(h,Math.min(l.bottomRow,e.bottomRow)),width:v=r.getRangeWidth(c,c)}:v=r.getRangeWidth(c,c);else for(p={value:r._repeatMergedValues?y:c===l.leftCol?y:'',height:a=r.getRangeHeight(h,h),width:v=r.getRangeWidth(Math.max(u.leftCol,l.leftCol),Math.min(u.rightCol,l.rightCol))},w=Math.min(u.rightCol,l.rightCol),b=c+1;b<=w;b++)f[b]+=a-r._borderWidth;else p={value:y,height:a=r.getRangeHeight(h,h),width:v=r.getRangeWidth(c,c)};p&&r._renderCell(n,p,i,d,h,c,k,f[c]);a&&(f[c]+=a-r._borderWidth);v&&(k+=v-r._borderWidth);w&&(c=w)}}})}},t.prototype._getCellValue=function(n,t){var u=this.panel,f=this.gr.getCellValue(u,n,t),r,e,o;return f||f===0||u.cellType!==i.CellType.Cell||(r=u.rows[t],r instanceof i.GroupRow&&r.dataItem&&r.dataItem.groupDescription&&n===u.columns.firstVisibleIndex&&(e=r.dataItem.groupDescription.propertyName,o=u.columns.getColumn(e),o&&o.header&&(e=o.header),f=e+': '+r.dataItem.name+' ('+r.dataItem.items.length+' items)')),f},t.prototype._isGroupRow=function(n){return n instanceof i.GroupRow&&n.hasChildren},t.prototype._renderCell=function(n,t,u,o,s,h,c,l){var v=e({},this._styles.cellStyle),w=this.panel,a,y,p;switch(w.cellType){case i.CellType.Cell:this._isGroupRow(u)?e(v,this._styles.groupCellStyle,!0):this.gr.isAlternatingRow(u)&&e(v,this._styles.altCellStyle,!0);break;case i.CellType.ColumnHeader:case i.CellType.RowHeader:case i.CellType.TopLeft:case i.CellType.BottomLeft:e(v,this._styles.headerCellStyle,!0);break;case i.CellType.ColumnFooter:e(v,this._styles.headerCellStyle,!0);e(v,this._styles.footerCellStyle,!0)}if(a=v,v.font&&((y=v.font.family)&&(a.fontFamily=y),(y=v.font.size)&&(a.fontSize=y),(y=v.font.style)&&(a.fontStyle=y),(y=v.font.weight)&&(a.fontWeight=y),v.font=undefined),u instanceof i.GroupRow&&!o.aggregate||(a.textAlign=o.getAlignment()),a.left=c,a.top=l,a.width=t.width,a.height=t.height,a.boxSizing='border-box',a.borderWidth=this._borderWidth,a.borderStyle='solid',p=w.grid,w.cellType===i.CellType.Cell&&p.rows.maxGroupLevel>=0&&h===p.columns.firstVisibleIndex){var b=u instanceof i.GroupRow?Math.max(u.level,0):p.rows.maxGroupLevel+1,k=f._asPt(a.paddingLeft||a.padding),d=f.pxToPt(b*p.treeIndent);a.paddingLeft=k+d}o.dataType===r.DataType.Boolean&&w.cellType===i.CellType.Cell&&!this._isGroupRow(u)&&this._isBoolean(t.value)?n._renderBooleanCell(t.value,a):n._renderTextCell(t.value,a)},t.prototype._isBoolean=function(n){var t=r.isString(n)&&n.toLowerCase();return t==='true'||t==='false'||n===!0||n===!1},t}(a);d=function(){function n(n){this._columns={};this._flex=n}return n.prototype.getMergedRange=function(n,t,i){var r=this._columns[i],u;return r&&t>=r.topRow&&t<=r.bottomRow?r:(u=this._flex.getMergedRange(n,t,i,!1),this._columns[i]=u?new g(n,u):null)},n}();g=function(n){function t(t,i){var u,f,r;for(n.call(this,i.row,i.col,i.row2,i.col2),this.firstVisibleRow=-1,u=this.topRow,f=this.bottomRow,r=u;r<f;r++)if(t.rows[r].isVisible){this.firstVisibleRow=r;break}}return c(t,n),t}(i.CellRange);o=function(){function n(n,t){this._flex=n;this._ranges=t||[]}return n.getSelection=function(t,r){var f=[],o,e,u,s;if(r===h.All)f.push(new i.CellRange(0,0,t.rows.length-1,t.columns.length-1));else{o=t.selection;switch(t.selectionMode){case i.SelectionMode.Cell:case i.SelectionMode.CellRange:f.push(o);break;case i.SelectionMode.Row:f.push(new i.CellRange(o.topRow,0,o.topRow,t.cells.columns.length-1));break;case i.SelectionMode.RowRange:f.push(new i.CellRange(o.topRow,0,o.bottomRow,t.cells.columns.length-1));break;case i.SelectionMode.ListBox:for(e=-1,u=0;u<t.rows.length;u++)s=t.rows[u],s.isSelected?(e<0&&(e=u),u===t.rows.length-1&&f.push(new i.CellRange(e,0,u,t.cells.columns.length-1))):(e>=0&&f.push(new i.CellRange(e,0,u-1,t.cells.columns.length-1)),e=-1)}}return new n(t,f)},n.prototype.length=function(){for(var n,i=0,t=0;t<this._ranges.length;t++)n=this._ranges[t],n.isValid&&(i+=n.bottomRow-n.topRow+1);return i},Object.defineProperty(n.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0}),n.prototype.clone=function(t,i){for(var r,f=[],u=0;u<this._ranges.length;u++)r=this._ranges[u].clone(),arguments.length>0&&(r.col=t),arguments.length>1&&(r.col2=i),f.push(r);return new n(this._flex,f)},n.prototype.getRenderSize=function(n){for(var u,t=new r.Size(0,0),i=0;i<this._ranges.length;i++)u=this._ranges[i].getRenderSize(n),t.width=Math.max(t.width,u.width),t.height+=u.height;return t},n.prototype.forEach=function(n,t){for(var i,r,f=0,u=0;u<this._ranges.length;u++)if(i=this._ranges[u],i.isValid)for(r=i.topRow;r<=i.bottomRow;r++)t(n.rows[r],i,r,f++)},n.prototype.subrange=function(t,r,u,f){var l=[],o,s,h,e;if(t>=0&&r>0)for(o=0,s=0,h=0;h<this._ranges.length&&r>0;h++,o=s+1)if(e=this._ranges[h],s=o+(e.bottomRow-e.topRow),!(t>s)){var c=t>o?e.topRow+(t-o):e.topRow,a=Math.min(e.bottomRow,c+r-1),v=arguments.length>2?u:e.leftCol,y=arguments.length>2?f:e.rightCol;l.push(new i.CellRange(c,v,a,y));r-=a-c+1}return new n(this._flex,l)},n}();nt=function(){function n(n,t,i){this._col=t;this._row=i;this._range=n}return Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0}),n}()}}})